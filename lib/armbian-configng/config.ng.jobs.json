{
    "menu": [
        {
            "id": "System",
            "description": "System wide and admin settings",
            "sub": [
                {
                    "id": "S01",
                    "description": "Enable Armbian kernel upgrades",
                    "command": [
                        "set_safe_boot unhold"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "[[ -n \"$(apt-mark showhold)\" ]]"
                },
                {
                    "id": "S02",
                    "description": "Disable Armbian kernel upgrades",
                    "command": [
                        "set_safe_boot freeze"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "[[ -z \"$(apt-mark showhold)\" ]]"
                },
                {
                    "id": "S03",
                    "description": "Edit the boot environment",
                    "command": [
                        "get_user_continue \"This will open /boot/armbianEnv.txt file to edit\nCTRL+S to save\nCTLR+X to exit\nwould you like to continue?\" process_input",
                        "nano /boot/armbianEnv.txt"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "S04",
                    "description": "Install Linux headers",
                    "command": [
                        "Headers_install"
                    ],
                    "status": "Pending Review",
                    "doc_link": "https://github.com/armbian/config/wiki#System",
                    "src_reference": "https://github.com/armbian/config/blob/master/debian-config-jobs#L160",
                    "author": "https://github.com/Tearran",
                    "condition": "! are_headers_installed"
                },
                {
                    "id": "S05",
                    "description": "Remove Linux headers",
                    "command": [
                        "Headers_remove"
                    ],
                    "status": "Pending Review",
                    "doc_link": "https://github.com/armbian/config/wiki#System",
                    "src_reference": "https://github.com/armbian/config/blob/master/debian-config-jobs#L160",
                    "author": "https://github.com/Tearran",
                    "condition": "are_headers_installed"
                },
                {
                    "id": "S06",
                    "description": "Install to internal storage",
                    "command": [
                        "armbian-install"
                    ],
                    "status": "Pending Review",
                    "doc_link": "https://github.com/armbian/config/wiki#System",
                    "src_reference": "",
                    "author": "https://github.com/igorpecovnik",
                    "condition": "[[ -n $(ls /sbin/armbian-install) ]]"
                },
                {
                    "id": "S07",
                    "description": "Manage SSH login options",
                    "sub": [
                            {
                            "id": "SS01",
                            "description": "Disable root login",
                            "command": [
                                           "sed -i \"s|^#\\?PermitRootLogin.*|PermitRootLogin no|\" /etc/ssh/sshd_config",
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q '^PermitRootLogin yes'  /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS02",
                            "description": "Enable root login",
                            "command": [
                                           "sed -i \"s/^#\\?PermitRootLogin.*/PermitRootLogin yes/\" /etc/ssh/sshd_config" ,
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q '^PermitRootLogin no' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS03",
                            "description": "Disable password login",
                            "command": [
                                           "sed -i \"s/^#\\?PasswordAuthentication.*/PasswordAuthentication no/\" /etc/ssh/sshd_config" ,
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q 'PasswordAuthentication yes' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS04",
                            "description": "Enable password login",
                            "command": [
                                           "sed -i \"s/^#\\?PasswordAuthentication.*/PasswordAuthentication yes/\" /etc/ssh/sshd_config" ,
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q 'PasswordAuthentication no' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS05",
                            "description": "Disable Public key authentication login",
                            "command": [
                                           "sed -i \"s/^#\\?PubkeyAuthentication.*/PubkeyAuthentication no/\" /etc/ssh/sshd_config" ,
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q 'PubkeyAuthentication yes' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS06",
                            "description": "Enable Public key authentication login",
                            "command": [
                                           "sed -i \"s/^#\\?PubkeyAuthentication.*/PubkeyAuthentication yes/\" /etc/ssh/sshd_config" ,
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q 'PubkeyAuthentication no' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS07",
                            "description": "Disable OTP authentication",
                            "command": [
                                           "clear",
                                           "! check_if_installed libpam-google-authenticator && ! check_if_installed qrencode || debconf-apt-progress -- apt-get -y purge libpam-google-authenticator qrencode",
                                           "sed -i \"s/^#\\?ChallengeResponseAuthentication.*/ChallengeResponseAuthentication no/\" /etc/ssh/sshd_config || sed -i \"0,/KbdInteractiveAuthentication/s//ChallengeResponseAuthentication yes/\" /etc/ssh/sshd_config" ,
                                           "sed -i '/^auth required pam_google_authenticator.so nullok/ d' /etc/pam.d/sshd",
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q 'ChallengeResponseAuthentication yes' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS08",
                            "description": "Enable OTP authentication",
                            "command": [
                                           "check_if_installed libpam-google-authenticator || debconf-apt-progress -- apt-get -y install libpam-google-authenticator",
                                           "check_if_installed qrencode || debconf-apt-progress -- apt-get -y install qrencode",
                                           "sed -i \"s/^#\\?ChallengeResponseAuthentication.*/ChallengeResponseAuthentication yes/\" /etc/ssh/sshd_config",
                                           "sed -i $'/KbdInteractiveAuthentication/{iChallengeResponseAuthentication yes\\n:a;n;ba}' /etc/ssh/sshd_config || sed -n -i '/password updating/{p;:a;N;/@include common-password/!ba;s/.*\\n/auth required pam_google_authenticator.so nullok\\nauth required pam_permit.so\\n/};p' /etc/pam.d/sshd",
                                           "[ ! -f /root/.google_authenticator ] && qr_code generate",
                                           "systemctl restart sshd.service"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "! check_if_installed libpam-google-authenticator || ! check_if_installed qrencode || grep -q '^ChallengeResponseAuthentication no' /etc/ssh/sshd_config || ! grep -q 'ChallengeResponseAuthentication' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS09",
                            "description": "Generate new OTP authentication QR code",
                            "command": [
                                           "qr_code generate"
                                       ],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "",
                            "condition": "grep -q '^ChallengeResponseAuthentication yes' /etc/ssh/sshd_config"
                            },
                            {
                            "id": "SS10",
                            "description": "Show OTP authentication QR code",
                            "command": ["qr_code"],
                            "status": "Active",
                            "doc_link": "",
                            "src_reference": "",
                            "author": "Igor Pecovnik",
                            "condition": "grep -q '^ChallengeResponseAuthentication yes' /etc/ssh/sshd_config && [ -f /root/.google_authenticator ]"
                            }
                           ]
                },
		    
                {
                    "id": "S08",
                    "description": "Change shell system wide to BASH",
                    "command": [
                        "export BASHLOCATION=$(grep /bash$ /etc/shells | tail -1)",
                        "sed -i \"s|^SHELL=.*|SHELL=${BASHLOCATION}|\" /etc/default/useradd",
                        "sed -i \"s|^DSHELL=.*|DSHELL=${BASHLOCATION}|\" /etc/adduser.conf",
                        "debconf-apt-progress -- apt-get -y purge armbian-zsh",
                        "update_skel",
                        "awk -F'[/:]' '{if ($3 >= 1000 && $3 != 65534 || $3 == 0) print $1}' /etc/passwd | xargs -L1 chsh -s $(grep /bash$ /etc/shells | tail -1)"
                    ],
                    "status": "Pending Review",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "https://github.com/igorpecovnik",
                    "condition": "[[ $(cat /etc/passwd | grep \"^root:\" | rev | cut -d\":\" -f1 | cut -d\"/\" -f1| rev) == \"zsh\" ]]"
                },
                {
                    "id": "S09",
                    "description": "Change shell system wide to ZSH",
                    "command": [
                        "export ZSHLOCATION=$(grep /zsh$ /etc/shells | tail -1)",
                        "sed -i \"s|^SHELL=.*|SHELL=${ZSHLOCATION}|\" /etc/default/useradd",
                        "sed -i \"s|^DSHELL=.*|DSHELL=${ZSHLOCATION}|\" /etc/adduser.conf",
                        "debconf-apt-progress -- apt-get -y install armbian-zsh",
                        "update_skel",
                        "awk -F'[/:]' '{if ($3 >= 1000 && $3 != 65534 || $3 == 0) print $1}' /etc/passwd | xargs -L1 chsh -s $(grep /zsh$ /etc/shells | tail -1)"
                    ],
                    "status": "Pending Review",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "https://github.com/igorpecovnik",
                    "condition": "[[ $(cat /etc/passwd | grep \"^root:\" | rev | cut -d\":\" -f1 | cut -d\"/\" -f1| rev) == \"bash\" ]]"
                }

            ]
        },
        {
            "id": "Network",
            "description": "Fixed and wireless network settings",
            "sub": [
                {
                    "id": "N01",
                    "description": "Configure network interfaces",
                    "sub": [
                            {
                                "id": "N02",
                                "description": "Apply configuration",
                                "command": [
                                    "netplan apply"
                                    ],
                                "status": "Active",
                                "doc_link": "",
                                "src_reference": "",
                                "author": "https://github.com/igorpecovnik",
                                "condition": ""
                            },
                            {
                                "id": "N03",
                                "description": "Wired",
                                "sub": [
                                    {
                                        "id": "N04",
                                        "description": "Show configuration",                                    
                                        "command": [ "show_message <<< \"$(sudo netplan get ethernets)\"" ],
                                        "condition": "[ -f /etc/netplan/30-*static-interfaces.yaml ] || [ -f /etc/netplan/10-dhcp-all-interfaces.yaml ]",
                                        "status": "Active",
                                        "author": "Igor Pecovnik"
                                    },
                                    {
                                        "id": "N05",
                                        "description": "Enable DHCP on all interfaces",
                                        "command": [
                                                    "rm -f /etc/netplan/30-*-static-interfaces.yaml",
                                                    "netplan set --origin-hint 10-dhcp-all-interfaces renderer=networkd",
                                                    "netplan set --origin-hint 10-dhcp-all-interfaces ethernets.all-eth-interfaces.dhcp4=true",
                                                    "netplan set --origin-hint 10-dhcp-all-interfaces ethernets.all-eth-interfaces.dhcp6=true",
                                                    "netplan set --origin-hint 10-dhcp-all-interfaces ethernets.all-eth-interfaces.match.name=e*",
                                                    "show_message <<< \"$(sudo netplan get ethernets)\""
                                                ],
                                        "status": "Active",
                                        "author": "Igor Pecovnik",
                                        "condition": "[ ! -f /etc/netplan/10-dhcp-all-interfaces.yaml ]"
                                    },
                                    {
                                        "id": "N06",
                                        "description": "Set fixed IP address",
                                        "command": [
                                            "rm -f /etc/netplan/10-dhcp-all-interfaces.yaml",
                                            "eth_index=\"eth0\"",
                                            "eth_ip=\"10.0.10.199/24\"",
                                            "netplan set --origin-hint 30-eth0-static-interfaces renderer=networkd",
                                            "netplan set --origin-hint 30-eth0-static-interfaces ethernets.${eth_index}.addresses=[$eth_ip]",
                                            "show_message <<< \"$(sudo netplan get ethernets)\""
                                                   ],
                                        "status": "Active",
                                        "doc_link": "",
                                        "src_reference": "",
                                        "author": "Igor Pecovnik",
                                        "condition": "[ -f /etc/netplan/10-dhcp-all-interfaces.yaml ] || true"
                                    },
                                    {
                                        "id": "N07",
                                        "description": "Disable wired networking",                                    
                                        "command": [ "rm -f /etc/netplan/10-dhcp-all-interfaces.yaml /etc/netplan/30-*static-interfaces.yaml" ],
                                        "condition": "[ -f /etc/netplan/30-*static-interfaces.yaml ] || [ -f /etc/netplan/10-dhcp-all-interfaces.yaml ]",
                                        "status": "Active",
                                        "author": "Igor Pecovnik"
                                    }
                                ]
                            },
                            {
                                "id": "N08",
                                "description": "Wireless",
                                "sub": [
                                    {
                                        "id": "N09",
                                        "description": "Show configuration",                                    
                                        "command": [ "show_message <<< \"$(sudo netplan get wifis)\"" ],
                                        "condition": "[ -f /etc/netplan/20-dhcp-wlan-interface.yaml ]",
                                        "status": "Active",
                                        "author": "Igor Pecovnik"
                                    },
                                    {
                                        "id": "N10",
                                        "description": "Disable wireless networking",
                                        "command": [ "rm -f /etc/netplan/20-dhcp-wlan-interface.yaml" ],
                                        "condition": "[ -f /etc/netplan/20-dhcp-wlan-interface.yaml ]",
                                        "status": "Active",
                                        "author": "Igor Pecovnik"
                                    },
                                    {
                                        "id": "N11",
                                        "description": "Disable IPV6 in wireless configuration",
                                        "command": [ 
                                                        "wifi_index=$(netplan get wifis | head -1 | cut -d\":\" -f1)",
                                                        "netplan set --origin-hint 20-dhcp-wlan-interface wifis.$wifi_index.dhcp6=false",
                                                        "show_message <<< \"$(sudo netplan get wifis)\""
                                                    ],
                                        "condition": "[ -f /etc/netplan/20-dhcp-wlan-interface.yaml ]",
                                        "status": "Active",
                                        "author": "Igor Pecovnik"
                                    },
                                    {
                                        "id": "N12",
                                        "description": "Enable DHCP on wireless network interface",
                                        "command": [
                                                    "wifi_index=\"wlx44334c47dec3\"",
                                                    "SSID=GOSTJE24",
                                                    "PASSWORD=password",
                                                    "rm -f /etc/netplan/20-dhcp-wlan-interface",
                                                    "netplan set --origin-hint 20-dhcp-wlan-interface renderer=networkd",
                                                    "netplan set --origin-hint 20-dhcp-wlan-interface wifis.$wifi_index.access-points.\"${SSID}\".${PASSWORD}=password",
                                                    "netplan set --origin-hint 20-dhcp-wlan-interface wifis.$wifi_index.dhcp4=true",
                                                    "netplan set --origin-hint 20-dhcp-wlan-interface wifis.$wifi_index.dhcp6=true",
                                                    "show_message <<< \"$(sudo netplan get wifis)\""
                                                ],
                                        "status": "Active",
                                        "author": "Igor Pecovnik",
                                        "condition": "[ ! -f /etc/netplan/20-dhcp-wlan-interface.yaml ]"
                                    }
                                ]
                            }
                            ]
                },
                {
                    "id": "N13",
                    "description": "Install Bluetooth support",
                    "command": [
                        "see_current_apt ",
                        "debconf-apt-progress -- apt-get -y install bluetooth bluez bluez-tools",
                        "check_if_installed xserver-xorg && debconf-apt-progress -- apt-get -y --no-install-recommends install pulseaudio-module-bluetooth blueman"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "! check_if_installed bluetooth && ! check_if_installed bluez && ! check_if_installed bluez-tools"
                },
                {
                    "id": "N14",
                    "description": "Remove Bluetooth support",
                    "command": [
                        "see_current_apt ",
						"debconf-apt-progress -- apt-get -y remove bluetooth bluez bluez-tools",
						"check_if_installed xserver-xorg && debconf-apt-progress -- apt-get -y remove pulseaudio-module-bluetooth blueman",
                        "debconf-apt-progress -- apt -y -qq autoremove"
		            ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "check_if_installed bluetooth || check_if_installed bluez || check_if_installed bluez-tools"
                },
                {
                    "id": "N15",
                    "description": "Bluetooth Discover",
                    "command": [
						"get_user_continue \"Verify that your Bluetooth device is discoverable!\" process_input ; connect_bt_interface"

                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "check_if_installed bluetooth || check_if_installed bluez || check_if_installed bluez-tools"
                },
                {
                    "id": "N16",
                    "description": "Toggle system IPv6/IPv4 internet protocol",
                    "command": [
                        "get_user_continue \"This will toggle your internet protocol\nWould you like to continue?\" process_input",
                        "toggle_ipv6 | show_infobox"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "N17",
                    "description": "Announce system in the network (Avahi)",
                    "command": [
                        "get_user_continue \"This operation will install avahi-daemon and add configuration files.\nDo you wish to continue?\" process_input",
                        "check_if_installed avahi-daemon",
						"debconf-apt-progress -- apt-get -y install avahi-daemon libnss-mdns",
						"cp /usr/share/doc/avahi-daemon/examples/sftp-ssh.service /etc/avahi/services/",
						"cp /usr/share/doc/avahi-daemon/examples/ssh.service /etc/avahi/services/",
						"service avahi-daemon restart"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "! check_if_installed avahi-daemon"
                },
                {
                    "id": "N18",
                    "description": "Disable system announce in the network (Avahi)",
                    "command": [
                        "get_user_continue \"This operation will purge avahi-daemon \nDo you wish to continue?\" process_input",
                        "check_if_installed avahi-daemon",
						"systemctl stop avahi-daemon avahi-daemon.socket",
						"debconf-apt-progress -- apt-get -y purge avahi-daemon"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": "",
                    "condition": "check_if_installed avahi-daemon"
                }
            ]
        },
        {
            "id": "Localisation",
            "description": "Localisation",
            "sub": [
                {
                    "id": "L00",
                    "description": "Change Global timezone (WIP)",
                    "command": [
						"dpkg-reconfigure tzdata"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "L01",
                    "description": "Change Locales reconfigure the language and character set",
                    "command": [
                        	"dpkg-reconfigure locales",
							"source /etc/default/locale ; sed -i \"s/^LANGUAGE=.*/LANGUAGE=$LANG/\" /etc/default/locale",
		                    "export LANGUAGE=$LANG"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "L02",
                    "description": "Change Keyboard layout",
                    "command": [
						"dpkg-reconfigure keyboard-configuration ; setupcon ",
			    "update-initramfs -u"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "L03",
                    "description": "Change APT mirrors",
                    "command": [
                        "get_user_continue \"This is only a frontend test\" process_input"
                    ],
                    "disabled": true,
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                }
            ]
        },
        {
            "id": "Software",
            "description": "Run/Install 3rd party applications",
            "sub": [
                {
                    "id": "I00",
                    "description": "Update Application Repository",
                    "command": [
                        "get_user_continue \"This will update apt\" process_input",
                        "debconf-apt-progress -- apt update"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "I01",
                    "description": "CLI System Monitor",
                    "command": [
                        "armbianmonitor -m | show_infobox"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                }
            ]
        },
        {
            "id": "Help",
            "description": "About this app",
            "sub": [
                {
                    "id": "H00",
                    "description": "About This system. (WIP)",
                    "command": [
                        "show_message <<< \"This app is to help execute procedures to configure your system\n\nSome options may not work on manually modified systems\""
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                },
                {
                    "id": "H02",
                    "description": "List of Config function(WIP)",
                    "command": [
                        "show_message <<< see_use"
                    ],
                    "status": "Active",
                    "doc_link": "",
                    "src_reference": "",
                    "author": ""
                }
            ]
        }
    ]
}
